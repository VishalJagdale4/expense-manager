<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e-Xpense Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background-color: #f0f2f5;
            padding-bottom: 80px; /* Space for FAB */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Card Styling */
        .custom-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
            background: white;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .card-header-clean {
            background: white;
            border-bottom: 1px solid #f0f0f0;
            padding: 15px 20px;
            font-weight: 700;
            color: #333;
        }

        /* Account Cards - Horizontal Scroll on Mobile, Grid on PC */
        .accounts-wrapper {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none; /* Firefox */
        }
        .accounts-wrapper::-webkit-scrollbar { display: none; } /* Chrome/Safari */

        .account-card-item {
            min-width: 240px; /* Width on mobile */
            flex: 0 0 auto;
        }

        /* Desktop: Make account cards grid-like */
        @media (min-width: 992px) {
            .accounts-wrapper {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                overflow-x: visible;
            }
            .account-card-item {
                min-width: auto;
            }
        }

        /* Chart Containers to fix sizing issues */
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
        }
        .pie-container {
            position: relative;
            height: 220px; /* Slightly smaller for Pies */
            width: 100%;
            display: flex;
            justify-content: center;
        }

        /* Floating Action Button */
        .fab-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #0d6efd, #0dcaf0);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(13, 110, 253, 0.4);
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            z-index: 1000;
        }
        .fab-btn:hover {
            transform: scale(1.1);
            color: white;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top mb-4 shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" href="#">
            <i class="bi bi-wallet2 me-2"></i> e-Xpense Manager
        </a>
        <span class="navbar-text text-white small d-none d-md-block">
                Welcome back, User
            </span>
    </div>
</nav>

<div class="container">

    <h6 class="text-muted mb-3 fw-bold">My Wallets</h6>
    <div class="accounts-wrapper mb-4">
        <div class="card custom-card account-card-item p-3">
            <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="bg-primary bg-opacity-10 p-2 rounded text-primary">
                    <i class="bi bi-bank fs-4"></i>
                </div>
                <span class="badge bg-success bg-opacity-10 text-success">Active</span>
            </div>
            <h6 class="text-muted mb-1">HDFC Main</h6>
            <h4 class="fw-bold mb-0">$12,450.00</h4>
        </div>
        <div class="card custom-card account-card-item p-3">
            <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="bg-danger bg-opacity-10 p-2 rounded text-danger">
                    <i class="bi bi-credit-card fs-4"></i>
                </div>
                <span class="badge bg-warning bg-opacity-10 text-warning">Due: 5th</span>
            </div>
            <h6 class="text-muted mb-1">Chase Credit</h6>
            <h4 class="fw-bold mb-0">$850.00</h4>
        </div>
        <div class="card custom-card account-card-item p-3">
            <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="bg-success bg-opacity-10 p-2 rounded text-success">
                    <i class="bi bi-cash fs-4"></i>
                </div>
                <span class="badge bg-secondary bg-opacity-10 text-secondary">Cash</span>
            </div>
            <h6 class="text-muted mb-1">Petty Cash</h6>
            <h4 class="fw-bold mb-0">$120.00</h4>
        </div>
    </div>

    <div class="row g-4">

        <div class="col-lg-7">

            <div class="card custom-card">
                <div class="card-header-clean d-flex justify-content-between align-items-center">
                    <span>Recent Transactions</span>
                    <a href="#" class="btn btn-sm btn-outline-primary">View All</a>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                        <tr class="small text-muted text-uppercase">
                            <th>Category</th>
                            <th>Account</th>
                            <th>Date</th>
                            <th class="text-end">Amount</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><i class="bi bi-cart text-info me-2"></i> Shopping (Grocery)</td>
                            <td><span class="badge bg-light text-dark border">HDFC</span></td>
                            <td class="small text-muted">Today, 10:30 AM</td>
                            <td class="text-end text-danger fw-bold">-$120.00</td>
                        </tr>
                        <tr>
                            <td><i class="bi bi-fuel-pump text-warning me-2"></i> Fuel (Car)</td>
                            <td><span class="badge bg-light text-dark border">Chase</span></td>
                            <td class="small text-muted">Yesterday</td>
                            <td class="text-end text-danger fw-bold">-$45.00</td>
                        </tr>
                        <tr>
                            <td><i class="bi bi-briefcase text-success me-2"></i> Salary</td>
                            <td><span class="badge bg-light text-dark border">HDFC</span></td>
                            <td class="small text-muted">Jan 25</td>
                            <td class="text-end text-success fw-bold">+$3,200.00</td>
                        </tr>
                        <tr>
                            <td><i class="bi bi-cup-hot text-secondary me-2"></i> Coffee</td>
                            <td><span class="badge bg-light text-dark border">Cash</span></td>
                            <td class="small text-muted">Jan 24</td>
                            <td class="text-end text-danger fw-bold">-$5.50</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card custom-card">
                <div class="card-header-clean">Total Balance Trend</div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card custom-card">
                <div class="card-header-clean text-danger">
                    <i class="bi bi-graph-down-arrow me-1"></i> Top 5 Expenses
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div><strong>Rent</strong> <span class="text-muted small ms-2">HDFC | Jan 01</span></div>
                        <span class="text-danger fw-bold">-$1,200.00</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div><strong>New Laptop</strong> <span class="text-muted small ms-2">Chase | Jan 15</span></div>
                        <span class="text-danger fw-bold">-$999.00</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div><strong>Car Insurance</strong> <span class="text-muted small ms-2">HDFC | Jan 10</span></div>
                        <span class="text-danger fw-bold">-$250.00</span>
                    </li>
                </ul>
            </div>

        </div>

        <div class="col-lg-5">

            <div class="card custom-card text-center">
                <div class="card-header-clean">Today's Category Split</div>
                <div class="card-body">
                    <div class="pie-container">
                        <canvas id="dailyPieChart"></canvas>
                    </div>
                    <div class="mt-3 p-3 bg-light rounded border">
                        <small class="text-uppercase text-muted fw-bold" id="pieLabel">Total Spent Today</small>
                        <h3 class="fw-bold mb-0 text-primary" id="pieValue">$170.50</h3>
                        <small class="text-muted" style="font-size: 0.75rem;">(Click chart to filter)</small>
                    </div>
                </div>
            </div>

            <div class="card custom-card">
                <div class="card-header-clean">Daily Expense (Last 7 Days)</div>
                <div class="card-body">
                    <div class="chart-container" style="height: 180px;">
                        <canvas id="dailyColumnChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card custom-card">
                <div class="card-header-clean">Balance by Account</div>
                <div class="card-body">
                    <div class="chart-container" style="height: 180px;">
                        <canvas id="accountBarChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card custom-card">
                <div class="card-header-clean">Monthly Overview</div>
                <div class="card-body">
                    <div class="pie-container">
                        <canvas id="monthlyPieChart"></canvas>
                    </div>
                </div>
            </div>

        </div>
    </div> </div>

<button class="fab-btn" data-bs-toggle="modal" data-bs-target="#transactionModal">
    <i class="bi bi-plus-lg"></i>
</button>

<div class="modal fade" id="transactionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">New Transaction</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Amount</label>
                        <input type="number" class="form-control form-control-lg" placeholder="0.00">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Category</label>
                        <select class="form-select">
                            <option>Food</option>
                            <option>Transport</option>
                            <option>Bills</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Account</label>
                        <select class="form-select">
                            <option>HDFC Main</option>
                            <option>Chase Credit</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary px-4">Save</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Common Options for better rendering
    const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
    };

    // 1. Balance Trend Chart (Line)
    new Chart(document.getElementById('trendChart'), {
        type: 'line',
        data: {
            labels: ['Jan 21', 'Jan 22', 'Jan 23', 'Jan 24', 'Jan 25', 'Jan 26', 'Jan 27'],
            datasets: [{
                label: 'Total Balance',
                data: [12000, 11950, 12100, 12050, 15250, 15100, 13420], // Salary jump
                borderColor: '#0d6efd',
                backgroundColor: 'rgba(13, 110, 253, 0.1)',
                tension: 0.3,
                fill: true
            }]
        },
        options: {
            ...commonOptions,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: false } }
        }
    });

    // 2. Daily Pie Chart + Drilldown Logic
    const dailyCtx = document.getElementById('dailyPieChart');
    const dailyDataValues = [120, 45, 5.5]; // Shopping, Fuel, Coffee
    const dailyLabels = ['Shopping', 'Fuel', 'Coffee'];
    const dailyColors = ['#0dcaf0', '#ffc107', '#6c757d'];

    const dailyPie = new Chart(dailyCtx, {
        type: 'doughnut',
        data: {
            labels: dailyLabels,
            datasets: [{
                data: dailyDataValues,
                backgroundColor: dailyColors,
                hoverOffset: 10,
                borderWidth: 0
            }]
        },
        options: {
            ...commonOptions,
            plugins: { legend: { position: 'bottom', labels: { boxWidth: 12 } } },
            onClick: (e, activeElements) => {
                const labelDisplay = document.getElementById('pieLabel');
                const valueDisplay = document.getElementById('pieValue');

                if (activeElements.length > 0) {
                    // A slice was clicked
                    const index = activeElements[0].index;
                    labelDisplay.innerText = dailyLabels[index] + " Spent";
                    valueDisplay.innerText = "$" + dailyDataValues[index].toFixed(2);
                } else {
                    // Clicked outside/center -> Reset
                    const total = dailyDataValues.reduce((a, b) => a + b, 0);
                    labelDisplay.innerText = "Total Spent Today";
                    valueDisplay.innerText = "$" + total.toFixed(2);
                }
            }
        }
    });

    // 3. Daily Columns (Bar)
    new Chart(document.getElementById('dailyColumnChart'), {
        type: 'bar',
        data: {
            labels: ['M', 'T', 'W', 'T', 'F', 'S', 'S'],
            datasets: [{
                label: 'Expense',
                data: [50, 120, 30, 80, 200, 40, 170],
                backgroundColor: '#6610f2',
                borderRadius: 4
            }]
        },
        options: {
            ...commonOptions,
            plugins: { legend: { display: false } },
            scales: {
                x: { grid: { display: false } },
                y: { display: false } // Hides Y axis for compact look
            }
        }
    });

    // 4. Account Balance (Horizontal Bar)
    new Chart(document.getElementById('accountBarChart'), {
        type: 'bar',
        data: {
            labels: ['HDFC', 'Chase', 'Cash'],
            datasets: [{
                data: [12450, 850, 120],
                backgroundColor: ['#0d6efd', '#dc3545', '#198754'],
                borderRadius: 4
            }]
        },
        options: {
            ...commonOptions,
            indexAxis: 'y', // Makes it horizontal
            plugins: { legend: { display: false } }
        }
    });

    // 5. Monthly Pie Chart
    new Chart(document.getElementById('monthlyPieChart'), {
        type: 'pie',
        data: {
            labels: ['Rent', 'Groceries', 'Utilities', 'Leisure'],
            datasets: [{
                data: [1200, 400, 150, 300],
                backgroundColor: ['#0d6efd', '#20c997', '#ffc107', '#fd7e14'],
                borderWidth: 0
            }]
        },
        options: {
            ...commonOptions,
            plugins: { legend: { position: 'bottom', labels: { boxWidth: 12 } } }
        }
    });
</script>
</body>
</html>